.\" For ascii version, process this file with
.\" groff -man -Tascii Sput.1
.\"
.TH Sput 1 "Jan 2003 " "Storage Resource Broker" "User SRB Commands"
.SH NAME
Sput \- imports one or more local files and/or directories into
SRB space.
.SH SYNOPSIS
.B Sput
.RB [ \-fprabvsmMkKV "] [" \-c
.IR container ]
.RB [ \-D
.IR dataType ]
.RB [ \-n
.IR replNum ]
.RB [ \-N
.IR numThreads ]
.RB [ \-S
.IR resourceName ]
.RB [ \-P
.IR pathName ]
.RB [ \-R
.IR  retry_count ]
.IR localFileName | localDirectory " ... " TargetName
.sp
.B Sput \-i
.RB [ \-a "] [" \-c
.IR container ]
.RB [ \-D
.IR dataType ]
.RB [ \-S
.IR resourceName ]
.RB [ \-P
.IR pathName ]
.RB [ \-R,\-\-retry
.IR retry_count ]
.RB [ \-k ]
.RB [ \-K ]
.I TargetName
.SH DESCRIPTION
.B "Sput "
reads one or more local files and|or directories and writes them
as object(s) in SRB space. Each new SRB object is also registered
in the MCAT.
.sp
The second synopsis reads data from standard input and writes it
as an object in SRB space.
.sp
The
.I localFileName
and|or
.I localDirectory
can be a path name in the local file hierarchy. The user should
have at least 'read' access permission for them. These inputs
can have wildcards.
.sp
The
.I TargetName
can be a path name in the collection hierarchy. The object
creation is done in the current collection, if
.I TargetName
is just an object-name. If a relative or absolute collection is
given in
.IR TargetName ,
then the object is stored in that collection. The user should have
write access permission for the collection. '.' can be used as a
.I TargetName
to denote the current collection.
.sp
If
.I TargetName
is a collection, then Sput uses the names of the local files as
SRB object names. The directory path of
.I localFileName
is not used in making the SRB object name.
.sp
If
.I TargetName
is an object-name (possibly with a collection path) and there are
more than one local file to be copied, then the
.I TargetName
is appended to the front of the local file names to make SRB
object names.
.sp
If given, the data type of the object is set to
.IR dataType .
Otherwise, Sput uses the file extender (i.e. string after the
last '.') to figure out the type. If it is unable to figure out
the data type, the 'generic' data type is used. Most popular
extenders in Unix and DOS will be supported. The data type
discovery is done in MCAT and hence future extenders can be
supported without any change in or compilation of the client code.
.sp
If given, the object is stored in
.IR resourceName .
Otherwise the object is stored in the default resource given by
DEFRESOURCE in the user environment file, located in
~/.srb/.MdasEnv
.sp
If given, the object is stored in
.IR pathName .
Otherwise the object is stored in the default path for the
resource stored in MCAT.
.sp
By default, Sput uses the serial I/O API to do the put.
The -m option or setting the environment variable "srbParallel" to any value can be used to set the transfer mode to the "server initiated connection" parallel I/O mode.
In this mode, the server is the active partner. The client listens passively on the control socket for instructions from the servers. Upon receiving the client's initial  request, the server with the help of informations from the MCAT, plans the execution of the data upload.
Typically it sends data transfer instructions to the server where the import resource is located. The resource server then subdivides the file to be imported into segments and spawns threads to handle the import of each segment in parallel.
One advantage of this scheme is data transfer is always directly between the resource server and client with no intermediate server in between.
.sp
A drawback of this mode is the client could be sitting behind a firewall and a server outside the firewall may not be able to connect to this client control socket.
.sp
The -M option which sets the transfer mode to the "client initiated connection" parallel I/O mode, was designed to get around the client's firewall issue. 
This mode is very similar to the "server initiated" mode except for the initial handshakes. 
In this mode, the control socket is on the resource server and the client spawns multiple threads, each initiating connection to the server control socket. After the connections have been established, the data transfer mechanism is the same as the "server initiated" mode.
.sp
Comparing with the "server initiated" mode, the overhead of the "client initiated" mode is slightly higher because of the more complicated initial handshakes. But for large file transfer, the difference is practically nothing.
.sp
In addition, with the -M option set, the [-N numthreads] can be used to suggest to the server on the number of threads to use for the parallel transfer. If this option is not used, the server will decide the number of threads based on an internal algorithm.
.sp
The -b option is for bulk loading of a large number of small files. It behaves like the -r option except runs a lot faster. Bulk loading of files into container is not supported in this command. Instead, the Sbload command should be used. 
.PP
.SH "OPTIONS"
.TP 0.5i
.B "\-h "
display command options
.TP 0.5i
.B "\-p "
prompts before writing each object to SRB space.
.TP 0.5i
.B "\-f "
force copying even if object exists.
.TP 0.5i
.B "\-a "
If the target object does not exist and the target resource is a logical resource consisting of more than one resources, then make a copy in each resources. If
the target object exists, force copying all replica of the target object.
.TP 0.5i
.B "\-b "
bulk loading directories recursively to SRB space.
.TP 0.5i
.B "\-r "
copy local directories recursively to SRB space.
.TP 0.5i
.B "\-v "
verbose mode. print out file size and transfer rate. If the transfer mode is parallel, the output contains one additional item - the number of threads used.
.TP 0.5i
.B "\-V "
verbose progress mode. print out progress status and ETA for sequential transfers. Does nothing for parallel transfers. It forces '-v' switch on.
.TP 0.5i
.B "\-k "
client checksum mode. Client computes simple checksum (sum -s, --sysv) of the local file and registers with MCAT. 
No verification is done on the server side.
.TP 0.5i
.B "\-K "
checksum verification mode. After the transfer, the server computes the checksum by reading back the file that was just stored.
This value is then compared with the source checksum value provided by the client for verification.
This verified checksum value is then registered with MCAT.
.TP 0.5i
.B "\-R "
.I "number of retries "
retry mode. Retries on any Sput error. The max retry count has to be specified. Sleeps 2,4,8,16,32,... seconds between retries.
.TP 0.5i
.B "\-s "
switch I/O mode to serial (default).
.TP 0.5i
.B "\-m "
set I/O mode to "server initiated" parallel I/O . Setting the environment variable "srbParallel" to any value achieves the same result.
.TP 0.5i
.B "\-M "
set I/O mode to "client initiated" parallel I/O mode.
.TP 0.5i
.B "\-N "
.I "numThreads"
The number of threads to use for the parallel transfer. Only valid with the -M option.
.TP 0.5i
.B "\-c "
container is the container where the target object will be stored.
.TP 0.5i
.B "\-i "
read data from standard input.
.TP 0.5i
.B "\-S "
.I "resourceName "
is the target resourceName.
.TP 0.5i
.B "\-n "
.I "replNum"
Overwrite only the replica with replica number replNum. This option is only valid if TargetName is a file and not a collection.
.SH "SEE ALSO"
.BR Sappend (1),
.BR Sget (1),
.BR Srsync (1),
.BR Stoken (1),
.BR SgetR (1),
.BR Smkdir (1)

