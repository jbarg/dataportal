# Makefile - This is the main makefile for testing MDAS-SRB link  software

include ../mk/mk.config
include ../mk/mk.common

TESTTARGETS = bin/test_srb_mdas_create_collections bin/test_srb_mdas_audit  bin/test_srb_mdas_get  bin/test_srb_mdas_all  bin/test_srb_mdas_get_rsrc bin/test_srb_mdas_get_collections bin/test_srb_mdas_auth  bin/test_srb_mdas_dir bin/test_srb_mdas_mod  bin/test_srb_mdas_modc bin/test_srb_mdas_modu bin/test_srb_mdas_create bin/test_srb_mdas_create_ugroup bin/test_srb_mdas_create_user bin/test_srb_mdas_move bin/test_srb_mdas_copy bin/test_srb_mdas_bload bin/test_srb_mdas_create_collection_path bin/test_srb_mdas_modr bin/test_srb_mdas_compound_obj
UTILTARGETS = bin/ingestResource bin/ingestLocation bin/ingestUser bin/ingestUsergroup bin/ingestCollection bin/ingestLogicalResource  bin/addLogicalResource bin/modifyUser bin/modifyResource   bin/ingestUserIntoGroup  bin/changeValue bin/deleteValue  bin/ingestToken bin/makeCompoundResource

OBJTARGETS = bin/ingestToken.o bin/ingestResource.o bin/ingestLocation.o  bin/ingestUser.o bin/ingestUsergroup.o  bin/ingestCollection.o bin/ingestLogicalResource.o  bin/addLogicalResource.o  bin/modifyUser.o bin/modifyResource.o  bin/ingestUserIntoGroup.o bin/mcatUtilLib.o bin/deleteValue.o bin/changeValue.o bin/makeCompoundResource.o

DBMS_LIB+=  -lc

SVR_CFLAGS+=-D$(PORTNAME) 
SVR_CFLAGS+=$(MY_CFLAG)  

ifeq ($(PORTNAME), PORTNAME_solaris)
DBMS_LIB+= -lgen
DBMS_LIB+=-lnsl -lsocket -lm -lthread
endif
ifeq ($(PORTNAME), PORTNAME_linux)
DBMS_LIB+=-lm -lpthread
endif

ifeq ($(PORTNAME), PORTNAME_aix)
DBMS_LIB+=-lm -lpthread
endif

ifeq ($(PORTNAME), PORTNAME_sgi)
DBMS_LIB+=-lm
endif

srbDir=..
clientObjDir=$(srbDir)/obj
msBinDir=$(srbDir)/obj

MS_OBJS = $(clientObjDir)/clGlobal.o $(msBinDir)/srbC_mdas_library.o 	\
$(msBinDir)/srbC_mdas_library2.o $(msBinDir)/srbC_mdas_library3.o $(msBinDir)/srbC_mdas_library6.o	 $(msBinDir)/srbC_mdas_library8.o \
$(msBinDir)/srbC_mdas_library9.o \
$(msBinDir)/mdasC_db2_conn.o $(msBinDir)/mdasC_db2_dcon.o 	\
$(msBinDir)/mdasC_db2_info_inquire.o $(msBinDir)/mdasC_api.o 	\
$(msBinDir)/mcatgeneral.o  \
$(msBinDir)/strct_lib.o $(msBinDir)/table_names_to_sql.o	\
$(msBinDir)/misc.o $(msBinDir)/elog.o $(msBinDir)/distrib.o 	\
$(msBinDir)/comm.o $(msBinDir)/auth.o $(clientObjDir)/libSrbClient.a


SRB_INCLUDE =  -I$(srbDir)/src/include -I$(srbDir)/src/catalog/include -I./include $(SVR_CFLAGS)
ifdef SEA_AUTH
MS_OBJS+=$(LIB_SEA)
endif

ifdef GSI_AUTH
ifeq ($(PORTNAME), PORTNAME_aix)
DBMS_LIB+= $(LIB_GSI_AUTH) 
else
DBMS_LIB+= $(LIB_GSI_AUTH) -z muldefs
endif
endif

ifdef DB2MCAT
MS_OBJS += $(msBinDir)/mdasC_db2_internal.o
endif
ifdef ORAMCAT
MS_OBJS += $(msBinDir)/mdasC_ora_internal.o
endif
ifdef SYBMCAT
MS_OBJS += $(msBinDir)/mdasC_syb_internal.o
endif
ifdef PSQMCAT
MS_OBJS += $(msBinDir)/mdasC_psq_internal.o
endif
ifdef MYSMCAT
MS_OBJS += $(msBinDir)/mdasC_mys_internal.o
endif
ifdef IFMXMCAT
MS_OBJS += $(msBinDir)/mdasC_ifmx_internal.o
endif



all:: $(TESTTARGETS) $(UTILTARGETS) $(OBJTARGETS) 

util: $(UTILTARGETS)

clean: 
	rm bin/test_srb_mdas*.o $(TESTTARGETS) $(UTILTARGETS) $(OBJTARGETS)

bin/modifyUser.o: utilities/modifyUser.c
	$(CC) -c -o  bin/modifyUser.o utilities/modifyUser.c $(SRB_INCLUDE) 
 
bin/modifyUser: bin/modifyUser.o $(MS_OBJS) 
	$(CC) -o bin/modifyUser  bin/modifyUser.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB)
 
bin/modifyResource.o: utilities/modifyResource.c
	$(CC) -c -o  bin/modifyResource.o utilities/modifyResource.c $(SRB_INCLUDE) 
 
bin/modifyResource: bin/modifyResource.o $(MS_OBJS) 
	$(CC) -o bin/modifyResource  bin/modifyResource.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB)
 
bin/makeCompoundResource.o: utilities/makeCompoundResource.c
	$(CC) -c -o  bin/makeCompoundResource.o utilities/makeCompoundResource.c $(SRB_INCLUDE) 
 
bin/makeCompoundResource: bin/makeCompoundResource.o $(MS_OBJS) 
	$(CC) -o bin/makeCompoundResource  bin/makeCompoundResource.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB)
 
bin/ingestToken.o: utilities/ingestToken.c
	$(CC) -c -o  bin/ingestToken.o utilities/ingestToken.c $(SRB_INCLUDE) 
 
bin/ingestToken: bin/ingestToken.o $(MS_OBJS) 
	$(CC) -o bin/ingestToken  bin/ingestToken.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB)
 
bin/ingestResource.o: utilities/ingestResource.c
	$(CC) -c -o  bin/ingestResource.o utilities/ingestResource.c $(SRB_INCLUDE)
 
bin/ingestResource: bin/ingestResource.o $(MS_OBJS)
	$(CC) -o bin/ingestResource  bin/ingestResource.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB)
 
bin/ingestLocation.o: utilities/ingestLocation.c
	$(CC) -c -o  bin/ingestLocation.o utilities/ingestLocation.c $(SRB_INCLUDE)
 
bin/ingestLocation: bin/ingestLocation.o $(MS_OBJS) 
	$(CC) -o bin/ingestLocation  bin/ingestLocation.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB)
 
bin/ingestCollection.o: utilities/ingestCollection.c
	$(CC) -c -o  bin/ingestCollection.o utilities/ingestCollection.c $(SRB_INCLUDE)
 
bin/ingestCollection: bin/ingestCollection.o $(MS_OBJS) 
	$(CC) -o bin/ingestCollection  bin/ingestCollection.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB)
 
bin/ingestUser.o: utilities/ingestUser.c
	$(CC) -c -o  bin/ingestUser.o utilities/ingestUser.c $(SRB_INCLUDE)
 
bin/ingestUser: bin/ingestUser.o $(MS_OBJS)
	$(CC) -o bin/ingestUser  bin/ingestUser.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB)
 
bin/ingestUsergroup.o: utilities/ingestUsergroup.c
	$(CC) -c -o  bin/ingestUsergroup.o utilities/ingestUsergroup.c $(SRB_INCLUDE)
 
bin/ingestUsergroup: bin/ingestUsergroup.o $(MS_OBJS)
	$(CC) -o bin/ingestUsergroup  bin/ingestUsergroup.o  $(MS_OBJS)  $(DBMS_INCLUDE) $(DBMS_LIB)
 
 
bin/ingestUserIntoGroup.o: utilities/ingestUserIntoGroup.c
	$(CC) -c -o  bin/ingestUserIntoGroup.o utilities/ingestUserIntoGroup.c $(SRB_INCLUDE)

bin/ingestUserIntoGroup: bin/ingestUserIntoGroup.o $(MS_OBJS)
	$(CC) -o bin/ingestUserIntoGroup  bin/ingestUserIntoGroup.o   $(MS_OBJS)  $(DBMS_INCLUDE) $(DBMS_LIB)

bin/ingestLogicalResource.o: utilities/ingestLogicalResource.c
	$(CC) -c -o  bin/ingestLogicalResource.o utilities/ingestLogicalResource.c $(SRB_INCLUDE)
 
bin/ingestLogicalResource: bin/ingestLogicalResource.o  $(MS_OBJS) 
	$(CC) -o bin/ingestLogicalResource  bin/ingestLogicalResource.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB)
 
bin/addLogicalResource.o: utilities/addLogicalResource.c
	$(CC) -c -o  bin/addLogicalResource.o utilities/addLogicalResource.c $(SRB_INCLUDE)
 
bin/addLogicalResource: bin/addLogicalResource.o $(MS_OBJS)
	$(CC) -o bin/addLogicalResource  bin/addLogicalResource.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB)
 
bin/mcatUtilLib.o: utilities/mcatUtilLib.c
	$(CC) -c -o  bin/mcatUtilLib.o utilities/mcatUtilLib.c $(SRB_INCLUDE)

bin/changeValue.o: utilities/changeValue.c
	$(CC) -c -o  bin/changeValue.o utilities/changeValue.c $(SRB_INCLUDE)
 
bin/changeValue: bin/changeValue.o bin/mcatUtilLib.o $(MS_OBJS)
	$(CC) -o bin/changeValue  bin/changeValue.o   bin/mcatUtilLib.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB)

bin/deleteValue.o: utilities/deleteValue.c
	$(CC) -c -o  bin/deleteValue.o utilities/deleteValue.c $(SRB_INCLUDE)
 
bin/deleteValue: bin/deleteValue.o bin/mcatUtilLib.o $(MS_OBJS)
	$(CC) -o bin/deleteValue  bin/deleteValue.o   bin/mcatUtilLib.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB)

bin/test_srb_mdas_get.o: test/test_srb_mdas_get.c
	$(CC) -c -o  bin/test_srb_mdas_get.o test/test_srb_mdas_get.c $(SRB_INCLUDE)

bin/test_srb_mdas_all.o: test/test_srb_mdas_all.c
	$(CC) -c -o  bin/test_srb_mdas_all.o test/test_srb_mdas_all.c $(SRB_INCLUDE)

bin/test_srb_mdas_get_collections.o: test/test_srb_mdas_get_collections.c
	$(CC) -c -o  bin/test_srb_mdas_get_collections.o test/test_srb_mdas_get_collections.c $(SRB_INCLUDE)

bin/test_srb_mdas_get_collection_id.o: test/test_srb_mdas_get_collection_id.c
	$(CC)  -c -o  bin/test_srb_mdas_get_collection_id.o test/test_srb_mdas_get_collection_id.c $(SRB_INCLUDE)

bin/test_srb_mdas_audit.o: test/test_srb_mdas_audit.c
	$(CC)  -c -o  bin/test_srb_mdas_audit.o test/test_srb_mdas_audit.c $(SRB_INCLUDE)

bin/test_srb_mdas_create_collections.o: test/test_srb_mdas_create_collections.c
	$(CC)  -c -o  bin/test_srb_mdas_create_collections.o test/test_srb_mdas_create_collections.c $(SRB_INCLUDE)

bin/test_srb_mdas_create_collection_path.o: test/test_srb_mdas_create_collection_path.c
	$(CC)  -c -o  bin/test_srb_mdas_create_collection_path.o test/test_srb_mdas_create_collection_path.c $(SRB_INCLUDE)

bin/test_srb_mdas_get_rsrc.o: test/test_srb_mdas_get_rsrc.c
	$(CC)  -c -o  bin/test_srb_mdas_get_rsrc.o test/test_srb_mdas_get_rsrc.c $(SRB_INCLUDE)

bin/test_srb_mdas_auth.o: test/test_srb_mdas_auth.c
	$(CC)  -c -o  bin/test_srb_mdas_auth.o test/test_srb_mdas_auth.c $(SRB_INCLUDE)



bin/test_srb_mdas_dir.o: test/test_srb_mdas_dir.c
	$(CC)  -c -o  bin/test_srb_mdas_dir.o test/test_srb_mdas_dir.c $(SRB_INCLUDE)

bin/test_srb_mdas_mod.o: test/test_srb_mdas_mod.c
	$(CC)  -c -o  bin/test_srb_mdas_mod.o test/test_srb_mdas_mod.c $(SRB_INCLUDE)

bin/test_srb_mdas_modc.o: test/test_srb_mdas_modc.c
	$(CC)  -c -o  bin/test_srb_mdas_modc.o test/test_srb_mdas_modc.c $(SRB_INCLUDE)

bin/test_srb_mdas_modu.o: test/test_srb_mdas_modu.c
	$(CC)  -c -o  bin/test_srb_mdas_modu.o test/test_srb_mdas_modu.c $(SRB_INCLUDE)

bin/test_srb_mdas_create_ugroup.o: test/test_srb_mdas_create_ugroup.c
	$(CC)  -c -o  bin/test_srb_mdas_create_ugroup.o test/test_srb_mdas_create_ugroup.c $(SRB_INCLUDE)

bin/test_srb_mdas_create.o: test/test_srb_mdas_create.c
	$(CC)  -c -o  bin/test_srb_mdas_create.o test/test_srb_mdas_create.c $(SRB_INCLUDE)

bin/test_srb_mdas_create_user.o: test/test_srb_mdas_create_user.c
	$(CC)  -c -o  bin/test_srb_mdas_create_user.o test/test_srb_mdas_create_user.c $(SRB_INCLUDE)

bin/test_srb_mdas_move.o: test/test_srb_mdas_move.c
	$(CC)  -c -o  bin/test_srb_mdas_move.o test/test_srb_mdas_move.c $(SRB_INCLUDE)

bin/test_srb_mdas_copy.o: test/test_srb_mdas_copy.c
	$(CC)  -c -o  bin/test_srb_mdas_copy.o test/test_srb_mdas_copy.c $(SRB_INCLUDE)  

bin/test_srb_mdas_bload.o: test/test_srb_mdas_bload.c
	$(CC)  -c -o  bin/test_srb_mdas_bload.o test/test_srb_mdas_bload.c $(SRB_INCLUDE)

bin/test_srb_mdas_modr.o: test/test_srb_mdas_modr.c
	$(CC)  -c -o  bin/test_srb_mdas_modr.o test/test_srb_mdas_modr.c $(SRB_INCLUDE)

bin/test_srb_mdas_compound_obj.o: test/test_srb_mdas_compound_obj.c
	$(CC)  -c -o  bin/test_srb_mdas_compound_obj.o test/test_srb_mdas_compound_obj.c $(SRB_INCLUDE)

bin/test_srb_mdas_get: bin/test_srb_mdas_get.o $(MS_OBJS)
	$(CC)  -o bin/test_srb_mdas_get  bin/test_srb_mdas_get.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB)

bin/test_srb_mdas_all: bin/test_srb_mdas_all.o $(MS_OBJS)
	$(CC)  -o bin/test_srb_mdas_all  bin/test_srb_mdas_all.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB) 

bin/test_srb_mdas_get_collections: bin/test_srb_mdas_get_collections.o $(MS_OBJS)
	$(CC)  -o bin/test_srb_mdas_get_collections  bin/test_srb_mdas_get_collections.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB) 

bin/test_srb_mdas_get_collection_id: bin/test_srb_mdas_get_collection_id.o $(MS_OBJS)
	$(CC)  -o bin/test_srb_mdas_get_collection_id  bin/test_srb_mdas_get_collection_id.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB) 

bin/test_srb_mdas_audit: bin/test_srb_mdas_audit.o $(MS_OBJS)
	$(CC)  -o bin/test_srb_mdas_audit  bin/test_srb_mdas_audit.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB) 

bin/test_srb_mdas_create_collections: bin/test_srb_mdas_create_collections.o $(MS_OBJS)
	$(CC)  -o bin/test_srb_mdas_create_collections  bin/test_srb_mdas_create_collections.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB) 

bin/test_srb_mdas_get_rsrc: bin/test_srb_mdas_get_rsrc.o $(MS_OBJS)
	$(CC)  -o bin/test_srb_mdas_get_rsrc  bin/test_srb_mdas_get_rsrc.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB) 

bin/test_srb_mdas_create_collection_path: bin/test_srb_mdas_create_collection_path.o $(MS_OBJS)
	$(CC)  -o bin/test_srb_mdas_create_collection_path  bin/test_srb_mdas_create_collection_path.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB) 

bin/test_srb_mdas_auth: bin/test_srb_mdas_auth.o $(MS_OBJS)
	$(CC)  -o bin/test_srb_mdas_auth  bin/test_srb_mdas_auth.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB) 



bin/test_srb_mdas_dir: bin/test_srb_mdas_dir.o $(MS_OBJS)
	$(CC)  -o bin/test_srb_mdas_dir  bin/test_srb_mdas_dir.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB) 

bin/test_srb_mdas_mod: bin/test_srb_mdas_mod.o $(MS_OBJS)
	$(CC)  -o bin/test_srb_mdas_mod bin/test_srb_mdas_mod.o   $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB) 

bin/test_srb_mdas_modc: bin/test_srb_mdas_modc.o $(MS_OBJS)
	$(CC)  -o bin/test_srb_mdas_modc bin/test_srb_mdas_modc.o   $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB) 

bin/test_srb_mdas_modu: bin/test_srb_mdas_modu.o $(MS_OBJS)
	$(CC)  -o bin/test_srb_mdas_modu bin/test_srb_mdas_modu.o   $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB) 

bin/test_srb_mdas_create: bin/test_srb_mdas_create.o  $(MS_OBJS)
	$(CC)  -o bin/test_srb_mdas_create bin/test_srb_mdas_create.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB) 

bin/test_srb_mdas_create_ugroup: bin/test_srb_mdas_create_ugroup.o  $(MS_OBJS)
	$(CC)  -o bin/test_srb_mdas_create_ugroup bin/test_srb_mdas_create_ugroup.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB) 

bin/test_srb_mdas_create_user: bin/test_srb_mdas_create_user.o  $(MS_OBJS)
	$(CC)  -o bin/test_srb_mdas_create_user bin/test_srb_mdas_create_user.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB) 

bin/test_srb_mdas_move: bin/test_srb_mdas_move.o  $(MS_OBJS)
	$(CC)  -o bin/test_srb_mdas_move bin/test_srb_mdas_move.o $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB) 

bin/test_srb_mdas_copy: bin/test_srb_mdas_copy.o  $(MS_OBJS)
	$(CC)  -o bin/test_srb_mdas_copy bin/test_srb_mdas_copy.o  $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB) 

bin/test_srb_mdas_modr: bin/test_srb_mdas_modr.o $(MS_OBJS)
	$(CC)  -o bin/test_srb_mdas_modr bin/test_srb_mdas_modr.o   $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB) 

bin/test_srb_mdas_bload: bin/test_srb_mdas_bload.o $(MS_OBJS)
	$(CC)  -o bin/test_srb_mdas_bload bin/test_srb_mdas_bload.o   $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB) 

bin/test_srb_mdas_compound_obj: bin/test_srb_mdas_compound_obj.o $(MS_OBJS)
	$(CC)   -o bin/test_srb_mdas_compound_obj bin/test_srb_mdas_compound_obj.o   $(MS_OBJS) $(DBMS_INCLUDE) $(DBMS_LIB) 
