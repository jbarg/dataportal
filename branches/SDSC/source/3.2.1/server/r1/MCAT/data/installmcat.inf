#!/bin/sh
# Install script for Informix
#
# Find where I am
#
if [ -f catalog.install.inf ]; then
 PREFIX=.
elif [ -f data/catalog.install.inf ]; then
 PREFIX=data;
else
 echo "Cannot determine current directory, exiting....";
 exit 1;
fi;
#
# Informix Env check
#
if [ -z "${INFORMIXDIR}" ]; then
 echo Informix environment not set, please source appropriate files and re-run
 exit 1;
fi
echo Clearing out old results
[ -f ${PREFIX}/myinstall.results.inf ] && rm ${PREFIX}/myinstall.results.inf
[ -f ${PREFIX}/mytest.results.inf ] && rm ${PREFIX}/mytest.results.inf
#
#
#
echo "Installing tables and initial values"
dbaccess -e mcat ${PREFIX}/catalog.install.inf > ${PREFIX}/myinstall.results.inf 2>&1
#
#
#
diff data/myinstall.results.db2 data/install.results.db2
wc ${PREFIX}/*install.results.db2
echo "installation completed. Successful if diff and wc results above are identical."
echo "testing started - this may take a few minutes"
cd bin
./test.catalog >& ../data/mytest.results.db2
cd ..
diff data/mytest.results.db2 data/test.results.db2
wc data/*test.results.db2
echo "testing completed. Successful if diff and wc results above are identical."
db2 connect reset
db2 terminate
echo "installation and testing completed."


